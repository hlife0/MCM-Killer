# Agent Knowledge Base Access Map

> **Version**: v3.1.0
> **Purpose**: Documents which agents require access to which external libraries
> **Last Updated**: 2026-01-25

---

## Overview

This document maps each MCM-Killer v3.1.0 agent to its required knowledge base access.
The external library functionality is now available, enabling agents to access:

1. **HMML 2.0** - Hierarchical Mathematical Methods Library
2. **Reference Papers** - O-Prize winning papers for training
3. **Functional Components** - Python tools from MM-Agent

---

## Knowledge Base Access Matrix

| Agent | HMML 2.0 | Reference Papers | Tools | Status |
|-------|----------|------------------|-------|--------|
| @metacognition_agent | READ | - | `journal_prompts.py`, `log_analyzer.py` | ✅ Verified |
| @knowledge_librarian | READ/WRITE | READ | `style_analyzer.py` | ✅ Verified |
| @researcher | READ | - | - | ✅ Verified |
| @modeler | READ | - | - | ✅ Verified |
| @narrative_weaver | - | - | `system_prompts.py` | ✅ Verified |
| @writer | - | READ | `system_prompts.py` | ✅ Verified |
| @editor | - | READ | - | ✅ Verified |
| @visualizer | - | - | - | ✅ Verified |
| @judge_zero | - | READ | - | ✅ Verified |
| @validator | READ | - | - | ✅ Verified |
| @advisor | READ | - | - | ✅ Verified |
| @feasibility_checker | READ | - | - | ✅ Verified |
| @director | - | - | - | ✅ Verified |
| @reader | - | - | - | ✅ Verified |
| @data_engineer | - | - | - | ✅ Verified |
| @code_translator | - | - | `safe_template.py`, `system_prompts.py` | ✅ Verified |
| @model_trainer | - | - | - | ✅ Verified |
| @summarizer | - | - | - | ✅ Verified |
| @time_validator | - | - | - | ✅ Verified |

---

## Required Knowledge Base Paths

### HMML 2.0 (Methods Library)

**Path**: `knowledge_library/methods/`

**Agents with READ access**:
- @knowledge_librarian (retrieves methods for Phase 0.2)
- @researcher (retrieves methods for problem analysis)
- @modeler (retrieves mathematical frameworks)
- @validator (validates method appropriateness)
- @advisor (provides method recommendations)
- @feasibility_checker (checks method feasibility)

**Agents with WRITE access**:
- @knowledge_librarian (updates method metadata, adds new methods)

**Structure**:
```
knowledge_library/
├── index.md                 # Master catalog
├── hmml_summary.json        # Machine-readable index
├── methods/
│   ├── optimization/        # LP, NLP, heuristics
│   ├── differential_equations/  # ODEs, PDEs, epidemic models
│   ├── statistics/          # Bayesian, frequentist, time series
│   ├── network_science/     # Centrality, community, dynamics
│   └── machine_learning/    # Supervised, unsupervised, deep learning
```

### Reference Papers

**Path**: `workspace/{year}_{problem}/reference_papers/`

**Agents with READ access**:
- @knowledge_librarian (Pre-Competition: style analysis)
- @writer (Phase 7: style reference)
- @editor (Phase 7.5: style enforcement)
- @judge_zero (Phase 9.1: O Award calibration)

**Example Path**: `workspace/2025_C/reference_papers/`

**Contains**: 44 O-Award winning papers in PDF format

### Functional Components

**Path**: `tools/`

**Components and Usage**:

| Component | Importing Agents | Usage |
|-----------|-----------------|-------|
| `system_prompts.py` | @narrative_weaver, @writer, @code_translator | Get cluster-specific system prompts |
| `safe_template.py` | @code_translator, all agents | Safe prompt formatting |
| `journal_prompts.py` | @metacognition_agent | Stage reflection prompts |
| `log_analyzer.py` | @metacognition_agent | Compress training logs |
| `style_analyzer.py` | @knowledge_librarian | Extract style patterns from PDFs |

---

## Agent-Specific Access Verification

### @metacognition_agent

**Required Access**:
1. `logs/summary.json` - Compressed training log (generated by `log_analyzer.py`)
2. `dev_diary_{i}.md` - Developer struggle documentation
3. `model_design_{i}.md` - Model design documents

**Tools Required**:
- `tools/journal_prompts.py` → `format_stage_prompt()`, `NARRATIVE_ARC_EXTRACTION`
- `tools/log_analyzer.py` → Generates `summary.json`

**Verification**: ✅ Paths correctly referenced in `agents/metacognition_agent.md:63-80`

### @knowledge_librarian

**Required Access**:
1. `reference_papers/` - O-Prize PDFs (READ)
2. `knowledge_library/` - HMML 2.0 structure (READ/WRITE)
3. `knowledge_library/academic_writing/style_guide.md` - Generated output (WRITE)

**Tools Required**:
- `tools/style_analyzer.py` → Extract patterns from PDFs

**Verification**: ✅ Paths correctly referenced in `agents/knowledge_librarian.md:29-32`

### @judge_zero

**Required Access**:
1. `workspace/{year}_{problem}/reference_papers/` - O-Prize papers (READ)

**Mandatory Protocol**:
- Before EVERY review, must study 3+ O Award papers
- Path reference: `agents/judge_zero.md:35`

**Verification**: ✅ O Award Training Protocol added in `agents/judge_zero.md:23-85`

### @writer / @editor

**Required Access**:
1. `reference_papers/` - For visual style matching
2. `templates/writing/latex_formatting_standards.md` - Formatting rules

**Verification**: ✅ Paths correctly referenced in `agents/writer_enhancement.md`

---

## External Library Integration

### HMML Integration with MM-Agent

The HMML structure in MCM-Killer v3.1.0 is compatible with MM-Agent's HMML:

**MM-Agent HMML Location**: `D:\migration\clean version\LLM-MM-Agent\MMAgent\HMML\HMML.md`

**MCM-Killer HMML 2.0 Location**: `knowledge_library/` (structured version)

**Migration Path**:
1. Use `tools/migrate_hmml.py` to convert flat HMML.md to structured HMML 2.0
2. HMML 2.0 adds: YAML front matter, narrative_value, common_pitfalls, O-Prize examples

### Reference Paper Integration

**Source**: O-Prize winning papers (44 available in `reference_papers/`)

**Access Pattern**:
```python
# Pre-Competition: @knowledge_librarian
papers = glob.glob("workspace/2025_C/reference_papers/*.pdf")
for paper in papers:
    patterns = style_analyzer.analyze(paper)

# Phase 9.1: @judge_zero
reference = load_pdf("workspace/2025_C/reference_papers/2425454.pdf")
calibrate_standards(reference)
```

---

## Verification Checklist

### Pre-Competition Verification

- [ ] HMML 2.0 structure exists at `knowledge_library/`
- [ ] Reference papers available at `workspace/{year}_{problem}/reference_papers/`
- [ ] All Python tools pass syntax check:
  ```bash
  python -m py_compile tools/system_prompts.py
  python -m py_compile tools/safe_template.py
  python -m py_compile tools/journal_prompts.py
  python -m py_compile tools/log_analyzer.py
  python -m py_compile tools/style_analyzer.py
  ```

### Per-Agent Verification

- [ ] @metacognition_agent can read logs and dev_diary
- [ ] @knowledge_librarian can read/write knowledge_library
- [ ] @judge_zero can access reference_papers
- [ ] @writer can access latex_formatting_standards.md
- [ ] @code_translator can import safe_template

---

## Troubleshooting

### Common Issues

| Issue | Agent | Solution |
|-------|-------|----------|
| FileNotFoundError for reference papers | @judge_zero | Check `workspace/{year}_{problem}/reference_papers/` exists |
| ImportError for tools | All | Ensure `tools/` is in Python path |
| HMML method not found | @researcher | Check `knowledge_library/index.md` for method registration |
| style_guide.md missing | @writer | Run Pre-Competition phase to generate via @knowledge_librarian |

### Debugging Commands

```bash
# Check if reference papers exist
ls workspace/2025_C/reference_papers/

# Verify HMML structure
ls knowledge_library/methods/

# Test tool imports
python -c "from tools.system_prompts import get_system_prompt_for_agent; print('OK')"
python -c "from tools.safe_template import safe_format; print('OK')"
python -c "from tools.journal_prompts import get_system_prompt; print('OK')"
```

---

**Document Version**: 1.0
**Created**: 2026-01-25
**Status**: Active
